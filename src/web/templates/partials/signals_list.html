{% from "components/signal_badge.html" import render as signal_badge %}

{% if signals %}
<div class="overflow-x-auto">
    <table class="w-full text-sm">
        <thead class="bg-muted/50">
            <tr>
                <th class="px-4 py-3 text-left font-medium text-muted-foreground">Symbol</th>
                <th class="px-4 py-3 text-left font-medium text-muted-foreground">Signal</th>
                <th class="px-4 py-3 text-left font-medium text-muted-foreground">Strategy</th>
                <th class="px-4 py-3 text-left font-medium text-muted-foreground">Status</th>
                <th class="px-4 py-3 text-right font-medium text-muted-foreground">Confidence</th>
                <th class="px-4 py-3 text-right font-medium text-muted-foreground">Time</th>
            </tr>
        </thead>
        <tbody class="divide-y divide-border">
            {% for signal in signals %}
            <tr class="hover:bg-muted/30 transition-colors">
                <td class="px-4 py-3">
                    <span class="font-medium">{{ signal.symbol }}</span>
                </td>
                <td class="px-4 py-3">
                    {{ signal_badge(signal.signal_type, 'small') }}
                </td>
                <td class="px-4 py-3 text-muted-foreground">
                    {{ signal.strategy or 'Unknown' }}
                </td>
                <td class="px-4 py-3">
                    {% if signal.execution_status == 'executed' %}
                    <span class="inline-flex items-center gap-1 text-xs px-2 py-0.5 rounded bg-profit/10 text-profit">
                        <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
                        </svg>
                        Executed
                    </span>
                    {% elif signal.execution_status == 'rejected' %}
                    <span class="inline-flex items-center gap-1 text-xs px-2 py-0.5 rounded bg-loss/10 text-loss cursor-help"
                          title="{{ signal.rejection_reason or 'Unknown reason' }}">
                        <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                        </svg>
                        Rejected
                    </span>
                    {% else %}
                    <span class="inline-flex items-center gap-1 text-xs px-2 py-0.5 rounded bg-muted text-muted-foreground">
                        <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
                        </svg>
                        Pending
                    </span>
                    {% endif %}
                </td>
                <td class="px-4 py-3 text-right">
                    <div class="flex items-center justify-end gap-2">
                        <div class="w-16 h-1.5 bg-muted rounded-full overflow-hidden">
                            <div class="h-full bg-primary rounded-full" style="width: {{ (signal.confidence * 100)|int }}%"></div>
                        </div>
                        <span class="font-medium text-xs w-10 text-right">{{ "%.0f"|format(signal.confidence * 100) }}%</span>
                    </div>
                </td>
                <td class="px-4 py-3 text-right text-muted-foreground text-xs">
                    {{ signal.timestamp|friendly_time }}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<!-- Results count -->
<div class="px-4 py-3 border-t border-border bg-muted/30 text-sm text-muted-foreground">
    Showing {{ signals|length }} signal{% if signals|length != 1 %}s{% endif %}
</div>
{% else %}
<div class="text-center py-12 text-muted-foreground">
    <svg class="mx-auto h-12 w-12 mb-3 opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/>
    </svg>
    <p class="font-medium">No signals found</p>
    <p class="text-sm mt-1">{% if current_filters and (current_filters.q or current_filters.status or current_filters.signal_type) %}Try adjusting your filters{% else %}Click "Generate Signals" to scan for opportunities{% endif %}</p>
</div>
{% endif %}
